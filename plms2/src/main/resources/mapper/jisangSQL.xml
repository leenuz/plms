<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="jisangSQL">
<select id="selectAllList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select * from jisang_master jm LEFT JOIN jisang_souja js ON js.js_jisang_no=jm.jm_jisang_no
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and jm.jm_jisang_no=#{idx}
		</if>
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(index)" >
		and jm_idx=cast(${index} as varchar)
		</if>
	</select>
	<select id="selectAllData" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *
		,concat(jm_sido_nm,' ',jm_sgg_nm,' ',jm_ri_nm,' ',jm_jibun) as address
		from jisang_master 
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and jm_jisang_no=#{idx}
		</if>
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(index)" >
		and jm_idx=cast(#{index} as integer)
		</if>
		
	</select>
	<select id="selectSoyujaData" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(row_number() over()) as no 
		from jisang_souja 
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and js_jisang_no=#{idx}
		</if>
		
		
	</select>
	
	<select id="selectPermitList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(row_number() over()) as no 
		from jisang_master jm left join jisang_permit_master jpm on jpm.jpm_dockey=jm.jm_dockey
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and jm.jm_jisang_no=#{idx}
		</if>
			AND jm.jm_dockey IS NOT null
		AND jpm.jpm_dockey IS NOT null
		
		
	</select>
	
	
	<select id="selectAtcFileList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(row_number() over()) as no 
		from jisang_atcfile 
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and ja_jisang_no=#{idx}
		</if>
		
		
	</select>
	
	<select id="selectModifyList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(row_number() over()) as no 
		from jisang_modify 
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and jm_jisang_no=#{idx}
		</if>
			
	</select>
	<select id="selectMergeList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(row_number() over()) as no 
		from jisang_merge 
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and jm_jisang_no=#{idx}
		</if>
			
	</select>
	<select id="selectIssueList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select (row_number() over()) as NO
		 , to_char(pi_issue_date,'YYYY-MM-DD HH:MM:SS') as issue_date
		 ,*
		  FROM potential_issue PI
		  LEFT JOIN 
		  (
		
				SELECT 
				jm.jm_jisang_no AS manage_no
				,COALESCE(jm.jm_comple_yn,'') AS comple_yn
				,COALESCE(jm.jm_permitted_yn,'') AS permitted_yn
				,SUBSTRING(jm.jm_jisang_no,1,1) AS rtype
				 FROM jisang_master jm
				 
				 UNION all
				 
				 
					SELECT 
				gm.gm_gover_no AS manage_no
				,COALESCE('','') AS comple_yn
				,COALESCE('','') AS permitted_yn
				,SUBSTRING(gm.gm_gover_no,1,1) AS rtype
				
				 FROM gover_master gm
				 
				 UNION all
				 
				 	SELECT 
				nm.nm_notset_no AS manage_no
				,COALESCE('','') AS comple_yn
				,COALESCE('','') AS permitted_yn
				,SUBSTRING(nm.nm_notset_no,1,1) AS rtype
				 FROM notset_master nm
		 
		 ) AS u
		 ON PI.pi_manage_no = u.manage_no
		 WHERE 1=1
		
		and pi_pnu=#{pnu}
			
	</select>
	<select id="selectIssueHistoryList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT *,(row_number() over()) as no 
		 FROM  potential_issue pi left join potential_issue_history pih on pi.pi_pnu=pih.pih_pnu 
		WHERE 1=1
		and pih_pnu=#{pnu}
		
			
	</select>
	
	<select id="selectPnuAtcFileList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(row_number() over()) as no 
		from pnu_atcfile 
		where 1=1
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(idx)" >
		and pa_manage_no=#{idx}
		</if>
		<if test="@org.apache.commons.lang3.ObjectUtils@isNotEmpty(pnu)" >
		and pa_pnu=#{pnu}
		</if>
	</select>
	
	
	<select id="selectIssueCodeAtcFileList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(row_number() over()) as no 
		from issue_code_atc_file 
		where 1=1
		
		and icaf_code in (#{issueManualCode1},#{issueManualCode2},#{issueManualCode3})
		
			
	</select>
	
	
	
	<select id="selectAllList2" parameterType="java.util.HashMap" resultType="java.util.HashMap"><![CDATA[
		select jm_set_money,jm_save_status from jisang_master 
	]]></select>
</mapper>